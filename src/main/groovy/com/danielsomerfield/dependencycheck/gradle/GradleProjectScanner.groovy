package com.danielsomerfield.dependencycheck.gradle

import org.gradle.api.Project
import org.owasp.dependencycheck.Engine
import org.owasp.dependencycheck.utils.Settings

class GradleProjectScanner {

  private Engine engine;

  public GradleProjectScanner(Engine engine) {
    this.engine = engine;
  }

  public GradleProjectScanner(){
    Settings.initialize()
    this.engine = new Engine()
  }

  public ScanResult scan(final Project project) {
    new ScanResult(FileVulnerabilities.getVulnerabilitiesForFiles(this.engine, GradleProjects.getFilesForProject(project)))
  }
}
