package com.danielsomerfield.cvecheck

import com.danielsomerfield.cvecheck.gradle.GradleProjectScanner
import com.danielsomerfield.cvecheck.gradle.ScanTask
import com.danielsomerfield.cvecheck.owaspdependencycheck.OWASPGradleProjectScanner
import org.owasp.dependencycheck.Engine
import org.owasp.dependencycheck.utils.Settings


class GradleTaskConfigurator {
  def ScanTask scanTask() {
    new ScanTask(scanner())
  }

  def GradleProjectScanner scanner() {
    new OWASPGradleProjectScanner(engine())
  }

  def Engine engine() {
    Settings.initialize()
    new Engine()
  }
}
