package com.danielsomerfield.cvecheck.gradle.handlers

import com.danielsomerfield.cvecheck.ScanResult
import com.danielsomerfield.cvecheck.ScanResultHandler
import org.gradle.api.GradleException
import org.slf4j.Logger
import org.slf4j.LoggerFactory

class AllowVulnScanResultHandler implements ScanResultHandler {
  private final Logger logger = LoggerFactory.getLogger(this.getClass())

  @Override
  def void handleScanResult(ScanResult scanResult) {
    if (scanResult.vulnCount > 0) {
      logger.info("Detected vulns!")
      throw new GradleException("${scanResult.vulnCount} vulnerabilities were detected")
    } else {
      logger.info("No vulnerabilities detected.")
    }
  }
}
