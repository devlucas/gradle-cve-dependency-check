package com.danielsomerfield.cvecheck.owaspdependencycheck

import com.danielsomerfield.cvecheck.ScanResult
import com.danielsomerfield.cvecheck.gradle.GradleProjectScanner
import com.danielsomerfield.cvecheck.reporting.ScanReportGenerator
import org.gradle.api.Project

class OWASPGradleProjectScanner implements GradleProjectScanner {

  private ScanReportGenerator<OWASPScanResult> scanReportGenerator;
  private ScanningEngine<OWASPScanResult> scanningEngine;

  public OWASPGradleProjectScanner(
      ScanReportGenerator<OWASPScanResult> scanReportGenerator,
      ScanningEngine<OWASPScanResult> scanResultCreator)
  {
    this.scanReportGenerator = scanReportGenerator
    this.scanningEngine = scanResultCreator
  }

  public ScanResult scan(final Project project) {
    final OWASPScanResult result = scanningEngine.createScanResult(project)
    scanReportGenerator.generateReport(result)
    result
  }
}


