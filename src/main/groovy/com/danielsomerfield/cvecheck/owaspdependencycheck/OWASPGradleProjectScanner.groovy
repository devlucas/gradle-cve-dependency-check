package com.danielsomerfield.cvecheck.owaspdependencycheck

import com.danielsomerfield.cvecheck.ScanResult
import com.danielsomerfield.cvecheck.gradle.GradleProjectScanner
import com.danielsomerfield.cvecheck.reporting.ScanReportGenerator
import org.gradle.api.Project
import org.owasp.dependencycheck.Engine

import static com.danielsomerfield.cvecheck.FileVulnerabilities.getVulnerabilitiesForFiles
import static com.danielsomerfield.cvecheck.gradle.GradleProjects.getFilesForProject

class OWASPGradleProjectScanner implements GradleProjectScanner {

  private ScanReportGenerator<OWASPScanResult> scanReportGenerator;
  private ScanResultCreator<OWASPScanResult> scanResultCreator;

  public OWASPGradleProjectScanner(
      ScanReportGenerator<OWASPScanResult> scanReportGenerator,
      ScanResultCreator<OWASPScanResult> scanResultCreator)
  {
    this.scanReportGenerator = scanReportGenerator
    this.scanResultCreator = scanResultCreator
  }

  public ScanResult scan(final Project project) {
    final OWASPScanResult result = scanResultCreator.createScanResult(project)
    scanReportGenerator.generateReport(result)
    result
  }
}


