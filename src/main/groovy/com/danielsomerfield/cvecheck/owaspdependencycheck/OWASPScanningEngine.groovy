package com.danielsomerfield.cvecheck.owaspdependencycheck

import org.gradle.api.Project
import org.owasp.dependencycheck.Engine

import static com.danielsomerfield.cvecheck.FileVulnerabilities.getVulnerabilitiesForFiles
import static com.danielsomerfield.cvecheck.gradle.GradleProjects.getFilesForProject

class OWASPScanningEngine implements ScanningEngine<OWASPScanResult> {

  private final Engine engine

  public OWASPScanningEngine(Engine engine) {
    this.engine = engine
  }

  def OWASPScanResult createScanResult(final Project project) {
    new OWASPScanResult(getVulnerabilitiesForFiles(engine, getFilesForProject(project)))
  }

  @Override
  void updateSource() {

  }
}
