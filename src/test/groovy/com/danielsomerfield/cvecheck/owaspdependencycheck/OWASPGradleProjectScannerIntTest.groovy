package com.danielsomerfield.cvecheck.owaspdependencycheck

import com.danielsomerfield.cvecheck.TestScaffold
import com.danielsomerfield.cvecheck.gradle.GradleProjectScanner
import com.danielsomerfield.cvecheck.ScanResult
import org.junit.Test
import org.owasp.dependencycheck.Engine

import static org.hamcrest.CoreMatchers.is
import static org.junit.Assert.assertThat

class OWASPGradleProjectScannerIntTest {

    private final Engine engine = TestScaffold.mockEngine()
    private final GradleProjectScanner projectScanner = new OWASPGradleProjectScanner(engine)

    @Test
    public void testBasicScan() {
        ScanResult result = projectScanner.scan(TestScaffold.mockProject())
        assertThat(result.vulnCount, is(2))
    }

}
