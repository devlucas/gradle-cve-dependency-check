package com.danielsomerfield.cvecheck.owaspdependencycheck

import com.danielsomerfield.cvecheck.TestScaffold
import com.danielsomerfield.cvecheck.gradle.GradleProjectScanner
import com.danielsomerfield.cvecheck.ScanResult
import org.junit.Test
import org.owasp.dependencycheck.Engine

import static com.danielsomerfield.cvecheck.TestScaffold.CREATE_TWO_VULNS_PER_DEPENDENCY
import static com.danielsomerfield.cvecheck.TestScaffold.mockEngine
import static com.danielsomerfield.cvecheck.TestScaffold.mockProject
import static org.hamcrest.CoreMatchers.is
import static org.junit.Assert.assertThat

class OWASPGradleProjectScannerIntTest {

    @Test
    public void testBasicScan() {
        ScanResult result = new OWASPGradleProjectScanner(mockEngine(CREATE_TWO_VULNS_PER_DEPENDENCY))
            .scan(mockProject())
        assertThat(result.vulnCount, is(2))
    }

    @Test
    public void testBasicScanWithNoVulns() {
        ScanResult result = new OWASPGradleProjectScanner(mockEngine()).scan(mockProject())
        assertThat(result.vulnCount, is(0))
    }


}
