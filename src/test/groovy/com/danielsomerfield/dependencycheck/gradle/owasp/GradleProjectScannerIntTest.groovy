package com.danielsomerfield.dependencycheck.gradle.owasp

import com.danielsomerfield.dependencycheck.gradle.GradleProjectScanner
import com.danielsomerfield.dependencycheck.gradle.ScanResult
import com.danielsomerfield.dependencycheck.gradle.TestScaffold
import org.junit.Test
import org.owasp.dependencycheck.Engine

import static com.danielsomerfield.dependencycheck.gradle.TestScaffold.mockEngine
import static org.hamcrest.CoreMatchers.is
import static org.junit.Assert.assertThat

class OWASPGradleProjectScannerIntTest {

    private final Engine engine = mockEngine()
    private final GradleProjectScanner projectScanner = new OWASPGradleProjectScanner(engine)

    @Test
    public void testBasicScan() {
        ScanResult result = projectScanner.scan(TestScaffold.mockProject())
        assertThat(result.vulnCount, is(2))
    }

}
