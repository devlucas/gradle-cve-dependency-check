package org.owasp.dependencycheck.gradle

import org.junit.Test
import org.owasp.dependencycheck.Engine
import org.owasp.dependencycheck.dependency.Vulnerability

import static org.hamcrest.CoreMatchers.is
import static org.junit.Assert.assertThat

class FileVulnerabilitiesTest {

  private List<File> files = [new File("file1"), new File("file2")]
  private Engine engine = TestScaffold.mockEngine()

  @Test
  public void testGetVulnerabilitiesForFiles() {
    Collection<Vulnerability> vulnerabilities = FileVulnerabilities.getVulnerabilitiesForFiles(engine, files);
    assertThat(vulnerabilities.size(), is(4));
    assertThat(vulnerabilities.get(0).getName(), is("file1.vuln-2"))
    assertThat(vulnerabilities.get(1).getName(), is("file1.vuln-1"))
    assertThat(vulnerabilities.get(2).getName(), is("file2.vuln-2"))
    assertThat(vulnerabilities.get(3).getName(), is("file2.vuln-1"))
  }

}
