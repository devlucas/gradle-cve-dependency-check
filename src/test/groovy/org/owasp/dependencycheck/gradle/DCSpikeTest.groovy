package org.owasp.dependencycheck.gradle

import org.junit.Test
import org.owasp.dependencycheck.Engine
import org.owasp.dependencycheck.data.nvdcve.CveDB
import org.owasp.dependencycheck.reporting.ReportGenerator
import org.owasp.dependencycheck.utils.Settings

class DCSpikeTest {

    @Test
    public void runTest() {

        final String applicationName = "fooApp";

        Settings.initialize()
        Engine engine = new Engine();
//        engine.scan(new File("build/libs/gradle-cve-dependency-check-0.1.0-DEV.jar"))
        engine.scan(new File("/Users/danielsomerfield/gap_workspace/cmf/build/target/ivy/repo-cache/springframework/spring-core/jars/spring-core-3.1.4.jar"))
        engine.analyzeDependencies()

        CveDB cveDB = new CveDB();
        final ReportGenerator reportGenerator = new ReportGenerator(
                applicationName,
                engine.getDependencies(),
                engine.getAnalyzers(),
                cveDB.databaseProperties)
        reportGenerator.generateReports(System.out, ReportGenerator.Format.XML)
    }

}
